<!DOCTYPE html>
<html>
<head>
  <style>
    /* Add some styling to position the button and chatbot container */
    .chatbot-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 20px;
      width: 120px;
      height: 120px;
    }
    .chatbot-container {
      display: none;
      position: fixed;
      bottom: 180px;
      right: 20px;
      background-color: #f2f2f2;
      padding: 20px;
      width: 300px;
      height: 400px;
      overflow: auto;
      border-radius: 10px;
    }
    .user-message {
        background-color: #ddd;
        padding: 10px;
        border-radius: 10px;
        margin-bottom: 10px;
        float: right;
        clear: both;
    }
    .chatbot-message {
        background-color: #eee;
        padding: 10px;
        border-radius: 10px;
        margin-bottom: 10px;
        float: left;
        clear: both;
    }
    /* Add styling for the form and input elements */
    .chatbot-form {
        position: absolute;
        bottom: 20px;
        width: 100%;
    }
    .chatbot-form input[type="text"] {
        width: 80%;
        padding: 12px 20px;
        margin: 8px 0;
        box-sizing: border-box;
        border: none;
        border-radius: 4px;
    }
    .chatbot-form input[type="button"] {
        width: 80%;
        background-color: black;
        color: white;
        padding: 14px 20px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    /* Add background image */
    body {
        background-image: url("background.jpg");
        background-repeat: no-repeat;
        background-size: cover;
    }
  </style>
</head>
<body>
  <img class="chatbot-button" id="chatbot-button" src="{{ url_for('static', filename='wave.gif') }}" onclick="toggleChatbot()">
  <div class="chatbot-container" id="chatbot-container">
    <div id="chatbot-messages">
      <p class="chatbot-message">Hello, I'm Rob the litmag robot. Its nice to meet you!</p>
    </div>
    <form class="chatbot-form">
      <input type="text" id="user-input" placeholder="Type your message here...">
      <input type="button" value="Send" onclick="sendMessage()">
    </form>
  </div>
  <script>
    var chatbotButton = document.getElementById("chatbot-button");
    var chatbotContainer = document.getElementById("chatbot-container");
    var userInput = document.getElementById("user-input");

    function toggleChatbot() {
        chatbotContainer.style.display = (chatbotContainer.style.display == "block") ? "none" : "block";
        chatbotButton.src = (chatbotButton.src.includes("wave.gif")) ? "{{ url_for('static', filename='chat.gif') }}" : "{{ url_for('static', filename='wave.gif') }}";
    }

    function sendMessage() {
        // Send a post request to the Flask route that handles the chatbot functionality
        fetch('/chatbot', {
            method: 'POST',
            body: JSON.stringify({'user_input': userInput.value}),
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then
        (data => {
            // Append the chatbot's response to the chatbot-messages div
            var messages = document.getElementById("chatbot-messages");
            messages.innerHTML += "<p>" + data.response + "</p>";
            // Clear the user input field
            userInput.value = "";
        });
    }
  </script>
</body>
</html>

